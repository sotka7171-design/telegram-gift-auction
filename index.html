<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Telegram Gift Auction Demo</title>

<style>
body {
  background:#0f0f0f;
  color:#fff;
  font-family:Arial, sans-serif;
  padding:20px;
}

h1 { margin-bottom:5px }
p { color:#aaa }

#lotBox {
  padding:15px;
  border:1px solid #333;
  background:#111;
  margin-bottom:15px;
  transition:transform 0.4s ease, opacity 0.4s ease;
}

.fade-out {
  opacity:0;
  transform:translateY(-10px);
}

.fade-in {
  opacity:1;
  transform:translateY(0);
}

#timer {
  font-size:42px;
  margin:10px 0;
}

#bar-container {
  width:320px;
  height:10px;
  background:#333;
}

#bar {
  height:100%;
  width:100%;
  background:#00bfff;
  transition:width 1s linear, background 0.3s;
}

button {
  margin-top:10px;
  padding:8px 16px;
}

#log {
  margin-top:20px;
  background:#111;
  border:1px solid #333;
  padding:10px;
  height:200px;
  overflow-y:auto;
  font-size:13px;
}

#lotList {
  margin-top:20px;
  border-top:1px solid #333;
  padding-top:10px;
}

.lotItem {
  font-size:14px;
  margin-bottom:5px;
}
</style>
</head>

<body>

<h1>Telegram Gift Auction</h1>
<p>Backend Auction Challenge demo</p>

<div id="lotBox" class="fade-in">
  <h2 id="lotName"></h2>
  <p>Start price: <span id="startPrice"></span> TON</p>
</div>

<h3>Round <span id="round">1</span></h3>
<p>
Highest bid: <span id="bid">0</span> TON<br>
Total bids: <span id="count">0</span>
</p>

<div id="timer">60</div>
<div id="bar-container"><div id="bar"></div></div>

<button onclick="placeBid('You')">Place bid</button>

<div id="log"></div>

<div id="lotList">
  <h3>Lots</h3>
</div>

<script>
const lots = [
  { name:"üöó Tesla Model S", start:10 },
  { name:"üì± iPhone 15 Pro", start:5 },
  { name:"üè† Beach House", start:100 },
  { name:"‚åö Rolex Submariner", start:25 }
];

const bots = ["Alex","Maria","CryptoFox","TON_Whale","User_394"];

let lotIndex = 0;
let round = 1;
let bid = 0;
let bidsCount = 0;
let timeLeft = 60;
let timer;
let botTimeout;

const logEl = document.getElementById("log");
const lotBox = document.getElementById("lotBox");

function log(text){
  const d=document.createElement("div");
  d.textContent=text;
  logEl.appendChild(d);
  logEl.scrollTop=logEl.scrollHeight;
}

function renderLotList(){
  const list=document.getElementById("lotList");
  lots.forEach((l,i)=>{
    const d=document.createElement("div");
    d.className="lotItem";
    d.textContent=(i===lotIndex?"‚ñ∂ ":"") + l.name;
    list.appendChild(d);
  });
}

function loadLot(){
  const lot=lots[lotIndex];
  lotBox.classList.add("fade-out");

  setTimeout(()=>{
    bid=lot.start;
    document.getElementById("lotName").textContent=lot.name;
    document.getElementById("startPrice").textContent=lot.start;
    lotBox.classList.remove("fade-out");
    lotBox.classList.add("fade-in");
    log(`üéÅ New lot: ${lot.name} (start ${lot.start} TON)`);
  },400);
}

function updateUI(){
  document.getElementById("round").textContent=round;
  document.getElementById("bid").textContent=bid;
  document.getElementById("count").textContent=bidsCount;
  document.getElementById("timer").textContent=timeLeft;

  const bar=document.getElementById("bar");
  bar.style.width=(timeLeft/60*100)+"%";
  bar.style.background=timeLeft<=10?"red":"#00bfff";
}

function startRound(){
  clearInterval(timer);
  clearTimeout(botTimeout);

  timeLeft=60;
  bidsCount=0;
  loadLot();
  updateUI();

  timer=setInterval(()=>{
    timeLeft--;
    updateUI();
    if(timeLeft<=0) endRound();
  },1000);

  scheduleBot();
}

function placeBid(who){
  const inc=Math.random()<0.7?1:Math.floor(Math.random()*3)+2;
  bid+=inc;
  bidsCount++;
  log(`üí∞ ${who} +${inc} ‚Üí ${bid} TON`);

  if(timeLeft<=8 && Math.random()<0.5){
    timeLeft+=10;
    log("‚è± Anti-sniping +10s");
  }
  updateUI();
}

function scheduleBot(){
  const delay=timeLeft>30?rand(4000,9000):rand(1500,4000);
  botTimeout=setTimeout(()=>{
    if(timeLeft>0 && Math.random()<0.75){
      placeBid("ü§ñ "+bots[rand(0,bots.length-1)]);
    }
    scheduleBot();
  },delay);
}

function endRound(){
  clearInterval(timer);
  clearTimeout(botTimeout);
  log(`üèÅ Sold for ${bid} TON`);
  lotIndex=(lotIndex+1)%lots.length;
  round++;

  setTimeout(()=>{
    document.getElementById("lotList").innerHTML="<h3>Lots</h3>";
    renderLotList();
    startRound();
  },4000);
}

function rand(min,max){
  return Math.floor(Math.random()*(max-min+1))+min;
}

renderLotList();
startRound();
</script>

</body>
</html>
