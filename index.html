<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Telegram Gift Auction Demo</title>

<style>
body {
  background:#0f0f0f;
  color:#fff;
  font-family:Arial, sans-serif;
  padding:20px;
}

h1 { margin-bottom:5px }
p { color:#aaa }

#lotBox {
  padding:15px;
  border:1px solid #333;
  background:#111;
  margin-bottom:15px;
  transition:opacity .4s, transform .4s;
}

.fade {
  opacity:0;
  transform:translateY(-10px);
}

.win-animation {
  animation: winFlash 1.5s ease-in-out;
  border-color: gold !important;
}

@keyframes winFlash {
  0% { background:#111; box-shadow:none; }
  30% { background:#1a1a00; box-shadow:0 0 20px gold; }
  60% { background:#111; box-shadow:0 0 30px gold; }
  100% { background:#111; box-shadow:none; }
}

#winnerBadge {
  font-size:22px;
  color:gold;
  margin-top:10px;
  display:none;
  animation: pop 0.8s ease-out;
}

@keyframes pop {
  0% { transform:scale(0.5); opacity:0 }
  100% { transform:scale(1); opacity:1 }
}

#timer { font-size:40px; margin:10px 0 }

#bar-container {
  width:320px;
  height:10px;
  background:#333;
}

#bar {
  height:100%;
  width:100%;
  background:#00bfff;
  transition:width 1s linear, background .3s;
}

button { margin-top:10px; padding:8px 16px }

#log, #lotList, #winners, #history {
  margin-top:20px;
  background:#111;
  border:1px solid #333;
  padding:10px;
  font-size:13px;
}

.lotItem { margin-bottom:5px }
.win { color:#6cff6c }
.hist { color:#ccc }
</style>
</head>

<body>

<h1>Telegram Gift Auction</h1>
<p>Backend Auction Challenge demo</p>

<div id="lotBox">
  <h2 id="lotName"></h2>
  <p>Start price: <span id="startPrice"></span> TON</p>
  <div id="winnerBadge">üèÜ YOU WON</div>
</div>

<h3>Round <span id="round">1</span></h3>
<p>
Highest bid: <span id="bid">0</span> TON<br>
Total bids: <span id="count">0</span>
</p>

<div id="timer">60</div>
<div id="bar-container"><div id="bar"></div></div>

<button onclick="placeBid('You')">Place bid</button>

<div id="log"></div>
<div id="lotList"><h3>Lots</h3></div>
<div id="winners"><h3>üèÜ Winners</h3></div>
<div id="history"><h3>üìú History</h3></div>

<script>
const lots = [
  {name:"üöó Tesla Model S", start:10},
  {name:"üì± iPhone 15 Pro", start:5},
  {name:"üè† Beach House", start:100},
  {name:"‚åö Rolex Submariner", start:25}
];

const bots = ["Alex","Maria","TON_Whale","CryptoFox","User_912"];

let lotIndex=0, round=1, bid=0, bids=0, timeLeft=60;
let timer, botTimer;
let winners=[], history=[];

const logEl=document.getElementById("log");
const lotBox=document.getElementById("lotBox");
const badge=document.getElementById("winnerBadge");

function log(t){
  const d=document.createElement("div");
  d.textContent=t;
  logEl.appendChild(d);
  logEl.scrollTop=logEl.scrollHeight;
}

function renderLots(){
  const l=document.getElementById("lotList");
  l.innerHTML="<h3>Lots</h3>";
  lots.forEach((x,i)=>{
    const d=document.createElement("div");
    d.className="lotItem";
    d.textContent=(i===lotIndex?"‚ñ∂ ":"")+x.name;
    l.appendChild(d);
  });
}

function renderWinners(){
  const w=document.getElementById("winners");
  w.innerHTML="<h3>üèÜ Winners</h3>";
  winners.slice(0,5).forEach(x=>{
    const d=document.createElement("div");
    d.className="win";
    d.textContent=`${x.lot} ‚Äî ${x.price} TON (${x.winner})`;
    w.appendChild(d);
  });
}

function renderHistory(){
  const h=document.getElementById("history");
  h.innerHTML="<h3>üìú History</h3>";
  history.slice(0,8).forEach(x=>{
    const d=document.createElement("div");
    d.className="hist";
    d.textContent=x;
    h.appendChild(d);
  });
}

function loadLot(){
  const lot=lots[lotIndex];
  lotBox.classList.add("fade");

  setTimeout(()=>{
    bid=lot.start;
    bids=0;
    badge.style.display="none";
    lotBox.classList.remove("win-animation");
    document.getElementById("lotName").textContent=lot.name;
    document.getElementById("startPrice").textContent=lot.start;
    lotBox.classList.remove("fade");
    log(`üéÅ New lot: ${lot.name}`);
    renderLots();
    updateUI();
  },400);
}

function updateUI(){
  document.getElementById("round").textContent=round;
  document.getElementById("bid").textContent=bid;
  document.getElementById("count").textContent=bids;
  document.getElementById("timer").textContent=timeLeft;
  document.getElementById("bar").style.width=(timeLeft/60*100)+"%";
  document.getElementById("bar").style.background=timeLeft<=10?"red":"#00bfff";
}

function startRound(){
  clearInterval(timer);
  clearTimeout(botTimer);
  timeLeft=60;
  loadLot();

  timer=setInterval(()=>{
    timeLeft--;
    updateUI();
    if(timeLeft<=0) endRound();
  },1000);

  botBid();
}

function placeBid(who){
  const inc=Math.random()<0.7?1:Math.floor(Math.random()*3)+2;
  bid+=inc;
  bids++;
  log(`üí∞ ${who} +${inc} ‚Üí ${bid} TON`);

  if(timeLeft<=8 && Math.random()<0.5){
    timeLeft+=10;
    log("‚è± Anti-sniping +10s");
  }
  updateUI();
}

function botBid(){
  botTimer=setTimeout(()=>{
    if(timeLeft>0 && Math.random()<0.75){
      placeBid("ü§ñ "+bots[Math.floor(Math.random()*bots.length)]);
    }
    botBid();
  }, timeLeft>30 ? rand(4000,9000) : rand(1500,4000));
}

function endRound(){
  clearInterval(timer);
  clearTimeout(botTimer);

  const winner = Math.random()<0.6
    ? "ü§ñ "+bots[Math.floor(Math.random()*bots.length)]
    : "You";

  winners.unshift({lot:lots[lotIndex].name, price:bid, winner});
  history.unshift(`${lots[lotIndex].name} ‚Äî ${bid} TON (${winner})`);

  log(`üèÅ Sold to ${winner} for ${bid} TON`);

  renderWinners();
  renderHistory();

  // üéâ –ê–ù–ò–ú–ê–¶–ò–Ø –¢–û–õ–¨–ö–û –ï–°–õ–ò –í–´–ò–ì–†–ê–õ –¢–´
  if(winner==="You"){
    badge.style.display="block";
    lotBox.classList.add("win-animation");
  }

  lotIndex=(lotIndex+1)%lots.length;
  round++;

  setTimeout(startRound,4000);
}

function rand(a,b){ return Math.floor(Math.random()*(b-a+1))+a }

renderLots();
startRound();
</script>

</body>
</html>
