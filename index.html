<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Telegram Gift Auction Demo</title>

<style>
body {
  background:#0f0f0f;
  color:#fff;
  font-family:Arial, sans-serif;
  padding:20px;
}

h1 { margin-bottom:5px }
p { color:#aaa }

#timer {
  font-size:48px;
  margin:15px 0;
}

#bar-container {
  width:340px;
  height:10px;
  background:#333;
}

#bar {
  height:100%;
  width:100%;
  background:#00bfff;
  transition:width 1s linear, background 0.3s;
}

button {
  margin-top:15px;
  padding:8px 16px;
}

#log {
  margin-top:20px;
  background:#111;
  border:1px solid #333;
  padding:10px;
  height:240px;
  overflow-y:auto;
  font-size:14px;
}
</style>
</head>

<body>

<h1>Telegram Gift Auction</h1>
<p>Backend Auction Challenge demo</p>

<h2>Round <span id="round">1</span></h2>
<p>Highest bid: <span id="bid">0</span> TON</p>
<p>Total bids: <span id="count">0</span></p>

<div id="timer">60</div>
<div id="bar-container"><div id="bar"></div></div>

<button onclick="placeBid('You')">Place bid</button>

<div id="log"></div>

<script>
let round = 1;
let bid = 0;
let bidsCount = 0;
let timeLeft = 60;
let timer;
let botTimeout;

const bots = ["Alex", "Maria", "Ivan", "CryptoFox", "TON_Whale", "User_394"];
const logEl = document.getElementById("log");

function log(text) {
  const d = document.createElement("div");
  d.textContent = text;
  logEl.appendChild(d);
  logEl.scrollTop = logEl.scrollHeight;
}

function updateUI() {
  document.getElementById("round").textContent = round;
  document.getElementById("bid").textContent = bid;
  document.getElementById("count").textContent = bidsCount;
  document.getElementById("timer").textContent = timeLeft;

  const bar = document.getElementById("bar");
  bar.style.width = (timeLeft/60*100) + "%";
  bar.style.background = timeLeft <= 10 ? "red" : "#00bfff";
}

function startRound() {
  clearInterval(timer);
  clearTimeout(botTimeout);

  timeLeft = 60;
  bid = 0;
  bidsCount = 0;
  log(`ðŸŸ¢ Round ${round} started`);
  updateUI();

  timer = setInterval(() => {
    timeLeft--;
    updateUI();
    if (timeLeft <= 0) endRound();
  }, 1000);

  scheduleBotBid();
}

function placeBid(who) {
  const inc = Math.random() < 0.7 ? 1 : Math.floor(Math.random()*3)+2;
  bid += inc;
  bidsCount++;

  log(`ðŸ’° ${who} bid +${inc} â†’ ${bid} TON`);

  if (timeLeft <= 8 && Math.random() < 0.5) {
    timeLeft += 10;
    log("â± Anti-sniping +10s");
  }

  updateUI();
}

function scheduleBotBid() {
  const delay =
    timeLeft > 30
      ? random(4000, 9000)
      : random(1500, 4000);

  botTimeout = setTimeout(() => {
    if (timeLeft > 0 && Math.random() < 0.75) {
      const bot = bots[random(0, bots.length-1)];
      placeBid("ðŸ¤– " + bot);
    }
    scheduleBotBid();
  }, delay);
}

function endRound() {
  clearInterval(timer);
  clearTimeout(botTimeout);
  log(`ðŸ Round ${round} ended. Winner bid: ${bid} TON`);
  setTimeout(() => {
    round++;
    startRound();
  }, 4000);
}

function random(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

startRound();
</script>

</body>
</html>
