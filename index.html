<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Telegram Gift Auction Demo</title>

<style>
body{background:#0f0f0f;color:#fff;font-family:Arial;padding:20px}
p{color:#aaa}
#lotBox{background:#111;border:1px solid #333;padding:15px;margin-bottom:15px;transition:.4s}
.fade{opacity:0;transform:translateY(-10px)}
.win-animation{animation:flash 1.5s}
@keyframes flash{30%{box-shadow:0 0 25px gold}}
#winnerBadge{display:none;color:gold;font-size:22px}
#timer{font-size:38px}
#bar-container{width:320px;height:10px;background:#333}
#bar{height:100%;background:#00bfff;transition:1s}
button,input{margin-top:6px;padding:6px}
.block{margin-top:20px;background:#111;border:1px solid #333;padding:10px}
.win{color:#6cff6c}
.hist{color:#ccc}
</style>
</head>

<body>

<h1>Telegram Gift Auction</h1>
<p>Backend Auction Challenge demo</p>

<div id="lotBox">
  <h2 id="lotName"></h2>
  <p>Start price: <span id="startPrice"></span> TON</p>
  <div id="winnerBadge">ğŸ† YOU WON</div>
</div>

<p>
Round <span id="round">1</span><br>
Highest bid: <span id="bid">0</span> TON<br>
Total bids: <span id="count">0</span>
</p>

<div id="timer">60</div>
<div id="bar-container"><div id="bar"></div></div>

<p>ğŸ’° Balance: <span id="balance">500</span> TON</p>
<input id="bidInput" type="number" placeholder="Your bid">
<button onclick="placeUserBid()">Place bid</button>
<br>
<input id="depositInput" type="number" placeholder="Deposit TON">
<button onclick="deposit()">Deposit</button>

<div class="block" id="log"></div>
<div class="block" id="lotList"></div>
<div class="block" id="winners"></div>
<div class="block" id="history"></div>

<script>
const lots=[
{name:"ğŸ¢ IT Business",start:80},
{name:"ğŸš— Tesla Model S",start:15},
{name:"ğŸš™ BMW X7",start:18},
{name:"ğŸ  Villa",start:120},
{name:"ğŸ˜ Apartment",start:60},
{name:"ğŸ‘• Luxury Jacket",start:8},
{name:"ğŸ“± iPhone 15 Pro",start:5},
{name:"âŒš Rolex",start:25},
{name:"ğŸ Mystery Box",start:12}
];
const bots=["Alex","Maria","TON_Whale","CryptoFox","Trader77"];
let lotIndex=0,round=1,bid=0,bids=0,timeLeft=60;
let userBalance=500,locked=0;
let timer,botTimer,winners=[],history=[];
const logEl=document.getElementById("log");

function log(t){logEl.innerHTML+=t+"<br>";logEl.scrollTop=9999}

function renderLots(){
  lotList.innerHTML="<b>Lots</b><br>"+lots.map((l,i)=>(i===lotIndex?"â–¶ ":"")+l.name).join("<br>");
}

function loadLot(){
  lotBox.classList.add("fade");
  setTimeout(()=>{
    bid=lots[lotIndex].start;
    bids=0;
    winnerBadge.style.display="none";
    lotBox.classList.remove("win-animation");
    lotName.textContent=lots[lotIndex].name;
    startPrice.textContent=lots[lotIndex].start;
    lotBox.classList.remove("fade");
    renderLots();
    updateUI();
    log("ğŸ New lot: "+lots[lotIndex].name);
  },400);
}

function updateUI(){
  roundSpan.textContent=round;
  bidSpan.textContent=bid;
  countSpan.textContent=bids;
  timerDiv.textContent=timeLeft;
  bar.style.width=(timeLeft/60*100)+"%";
  balance.textContent=userBalance;
}

function startRound(){
  clearInterval(timer);clearTimeout(botTimer);
  timeLeft=60;
  loadLot();
  timer=setInterval(()=>{timeLeft--;updateUI();if(timeLeft<=0)endRound()},1000);
  botBid();
}

function placeUserBid(){
  const a=Number(bidInput.value);
  if(a<=bid||a<=0||a>userBalance) return alert("Invalid bid");
  bid=a;bids++;locked=a;
  log("ğŸ’° You bid "+a+" TON");
  if(timeLeft<=8) timeLeft+=10;
  updateUI();bidInput.value="";
}

function botBid(){
  botTimer=setTimeout(()=>{
    if(timeLeft>0 && Math.random()<0.7){
      bid+=Math.floor(Math.random()*3)+1;
      bids++;
      log("ğŸ¤– Bot bid â†’ "+bid+" TON");
    }
    botBid();
  },timeLeft>30?4000:2000);
}

function endRound(){
  clearInterval(timer);clearTimeout(botTimer);
  const win=Math.random()<0.55?"ğŸ¤– "+bots[Math.floor(Math.random()*bots.length)]:"You";
  if(win==="You"){
    userBalance-=locked;
    winnerBadge.style.display="block";
    lotBox.classList.add("win-animation");
  }
  locked=0;
  winners.unshift(lots[lotIndex].name+" â€” "+bid+" TON ("+win+")");
  history.unshift(lots[lotIndex].name+" â€” "+bid+" TON ("+win+")");
  winnersBox.innerHTML="<b>Winners</b><br>"+winners.slice(0,5).join("<br>");
  historyBox.innerHTML="<b>History</b><br>"+history.slice(0,8).join("<br>");
  log("ğŸ Sold to "+win);
  lotIndex=(lotIndex+1)%lots.length;
  round++;
  setTimeout(startRound,4000);
}

function deposit(){
  const d=Number(depositInput.value);
  if(d>0){userBalance+=d;updateUI();depositInput.value="";log("â• Deposit "+d+" TON")}
}

const roundSpan=document.getElementById("round");
const bidSpan=document.getElementById("bid");
const countSpan=document.getElementById("count");
const timerDiv=document.getElementById("timer");
const bar=document.getElementById("bar");
const balance=document.getElementById("balance");
const lotBox=document.getElementById("lotBox");
const lotName=document.getElementById("lotName");
const startPrice=document.getElementById("startPrice");
const winnerBadge=document.getElementById("winnerBadge");
const lotList=document.getElementById("lotList");
const winnersBox=document.getElementById("winners");
const historyBox=document.getElementById("history");
const bidInput=document.getElementById("bidInput");
const depositInput=document.getElementById("depositInput");

startRound();
</script>

</body>
</html>
